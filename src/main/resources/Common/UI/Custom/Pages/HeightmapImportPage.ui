// Hytale UI Definition: Heightmap Import
// Controller: HeightmapImportPage.java

$C = "../Common.ui";
$Sounds = "../Sounds.ui";

$C.@PageOverlay #MainPage {
  Anchor: (Top: 130);
}

Group #FormContainer {
  LayoutMode: Top;

  $C.@DecoratedContainer {
    Anchor: (Left: 50, Top: 170, Width: 460);

    #Title {
      $C.@Title {
        @Text = %server.customUI.heightmapImport.title;
      }
    }

    #Content {
      LayoutMode: Top;
      Padding: (Full: 16);

      Label {
        Anchor: (Bottom: 12);
        Style: (...$C.@DefaultLabelStyle, Wrap: true, FontSize: 14, TextColor: #94969a);
        Text: %server.customUI.heightmapImport.description;
      }

      Group {
        LayoutMode: Top;
        Anchor: (Bottom: 8);
        Background: (TexturePath: "../Common/ContainerPanelPatch.png", Border: 4);
        Padding: (Full: 12);

        // ── File path ──────────────────────────────────────────────────────
        Group #HeightmapPath {
          LayoutMode: Top;
          Anchor: (Bottom: 10);

          Label {
            Text: %server.customUI.heightmapImport.filePath;
            Anchor: (Bottom: 4);
            Style: $C.@DefaultLabelStyle;
          }

          Group {
            LayoutMode: Left;
            Anchor: (Height: 35);

            $C.@TextField #Input {
              @Anchor = (Left: 0, Right: 8);
              FlexWeight: 1;
              MaxLength: 1024;
              PlaceholderText: "imports/heightmaps/terrain.png";
            }

            $C.@SecondaryTextButton #BrowseButton {
              @Anchor = (Width: 140);
              Text: %server.customUI.browse;
            }
          }
        }

        // ── Height scale ───────────────────────────────────────────────────
        Group #HeightScaleInput {
          LayoutMode: Left;
          Anchor: (Bottom: 8, Height: 35);

          Label {
            Text: %server.customUI.heightmapImport.heightScale;
            Anchor: (Width: 140);
            Style: (...$C.@DefaultLabelStyle, VerticalAlignment: Center);
          }

          $C.@NumberField #Input {
            @Anchor = (Width: 90);
            Format: (
              MaxDecimalPlaces: 0,
              Step: 1,
              MinValue: 1,
              MaxValue: 320
            );
          }
        }

        // ── Base block ─────────────────────────────────────────────────────
        Group #BaseBlock {
          LayoutMode: Top;
          Anchor: (Bottom: 8);

          Label {
            Text: %server.customUI.heightmapImport.baseBlock;
            Anchor: (Bottom: 4);
            Style: $C.@DefaultLabelStyle;
          }

          $C.@TextField #Input {
            @Anchor = (Left: 0);
            MaxLength: 512;
            PlaceholderText: "Rock_Stone or 50%Rock_Stone,50%Rock_Basalt";
          }
        }

        // ── Import mode ────────────────────────────────────────────────────
        Group #ImportModeInput {
          LayoutMode: Left;
          Anchor: (Bottom: 8, Height: 35);

          Label {
            Text: %server.customUI.heightmapImport.importMode;
            Anchor: (Width: 140);
            Style: (...$C.@DefaultLabelStyle, VerticalAlignment: Center);
          }

          $C.@DropdownBox #Input {
            Anchor: (Width: 200, Height: $C.@DropdownBoxHeight);
          }
        }

        // ── Channel (for multi-channel files) ─────────────────────────────
        Group #ChannelInput {
          LayoutMode: Left;
          Anchor: (Bottom: 8, Height: 35);

          Label {
            Text: %server.customUI.heightmapImport.channel;
            Anchor: (Width: 140);
            Style: (...$C.@DefaultLabelStyle, VerticalAlignment: Center);
          }

          $C.@DropdownBox #Input {
            Anchor: (Width: 200, Height: $C.@DropdownBoxHeight);
          }
        }

        // ── Colormap block: secondary map path ────────────────────────────
        Group #ColormapPath {
          LayoutMode: Top;
          Anchor: (Bottom: 8);
          Visible: false;

          Label {
            Text: %server.customUI.heightmapImport.colormapPath;
            Anchor: (Bottom: 4);
            Style: $C.@DefaultLabelStyle;
          }

          Group {
            LayoutMode: Left;
            Anchor: (Height: 35);

            $C.@TextField #Input {
              @Anchor = (Left: 0, Right: 8);
              FlexWeight: 1;
              MaxLength: 1024;
              PlaceholderText: "imports/heightmaps/terrain_color.png";
            }

            $C.@SecondaryTextButton #BrowseButton {
              @Anchor = (Width: 140);
              Text: %server.customUI.browse;
            }
          }
        }

        // ── Invert heights ─────────────────────────────────────────────────
        Group #InvertContainer {
          LayoutMode: Left;
          Anchor: (Top: 4, Bottom: 8);

          $C.@CheckBoxWithLabel #InvertCheckbox {
            @Text = %server.customUI.heightmapImport.invertHeight;
            @Checked = false;
          }
        }

        // ── Smooth pass ────────────────────────────────────────────────────
        Group #SmoothContainer {
          LayoutMode: Left;
          Anchor: (Top: 4, Bottom: 8);

          $C.@CheckBoxWithLabel #SmoothCheckbox {
            @Text = %server.customUI.heightmapImport.smooth;
            @Checked = false;
          }
        }

        // ── Origin ─────────────────────────────────────────────────────────
        Group #OriginInput {
          LayoutMode: Left;
          Anchor: (Bottom: 8, Height: 35);

          Label {
            Text: %server.customUI.heightmapImport.origin;
            Anchor: (Width: 140);
            Style: (...$C.@DefaultLabelStyle, VerticalAlignment: Center);
          }

          $C.@DropdownBox #Input {
            Anchor: (Width: 200, Height: $C.@DropdownBoxHeight);
          }
        }

        // ── Max size cap ───────────────────────────────────────────────────
        Group #MaxSizeInput {
          LayoutMode: Left;
          Anchor: (Height: 35);

          Label {
            Text: %server.customUI.heightmapImport.maxSize;
            Anchor: (Width: 140);
            Style: (...$C.@DefaultLabelStyle, VerticalAlignment: Center);
          }

          $C.@NumberField #Input {
            @Anchor = (Width: 90);
            Format: (
              MaxDecimalPlaces: 0,
              Step: 8,
              MinValue: 1,
              MaxValue: 1024
            );
          }
        }
      }

      Label #PreviewInfo {
        Anchor: (Vertical: 6);
        Style: (...$C.@DefaultLabelStyle, Wrap: true, TextColor: #7a9ab5, FontSize: 13);
        Visible: false;
      }

      Label #StatusText {
        Anchor: (Vertical: 8);
        Style: (...$C.@DefaultLabelStyle, Wrap: true, TextColor: #cfd8e3, FontSize: 14);
        Visible: false;
      }

      Group {
        LayoutMode: Top;
        Anchor: (Top: 6);

        $C.@TextButton #ImportButton {
          Text: %server.customUI.heightmapImport.importButton;
        }
      }
    }
  }
}

// ── Browser modal ──────────────────────────────────────────────────────────
$C.@PageOverlay #BrowserPage {
  LayoutMode: Middle;
  Visible: false;

  $C.@DecoratedContainer {
    Anchor: (Width: 600, Height: 550);

    #Title {
      $C.@Title {
        @Text = %server.customUI.heightmapImport.browserTitle;
      }
    }

    #Content {
      LayoutMode: Top;
      Padding: (Full: 16);

      Label #CurrentPath {
        Anchor: (Bottom: 8, Horizontal: 4);
        Style: (...$C.@DefaultLabelStyle, FontSize: 12, TextColor: #6a7d8f);
        Text: "/";
      }

      Group #BrowserContent {
        FlexWeight: 1;

        Group {
          LayoutMode: Top;

          Group {
            LayoutMode: Left;
            Anchor: (Bottom: 10, Height: $C.@DropdownBoxHeight);

            $C.@TextField #SearchInput {
              @Anchor = (Left: 0);
              FlexWeight: 1;
              PlaceholderText: %server.customUI.heightmapImport.searchPlaceholder;
            }
          }

          Group #FileList {
            FlexWeight: 1;
            LayoutMode: TopScrolling;
            ScrollbarStyle: $C.@DefaultScrollbarStyle;
          }
        }
      }

      Group #BrowserButtons {
        LayoutMode: Center;
        Anchor: (Top: 12);

        $C.@TextButton #SelectButton {
          @Sounds = $Sounds.@SaveSettings;
          @Anchor = (Right: 4);
          Text: %server.customUI.select;
          FlexWeight: 1;
        }

        $C.@SecondaryTextButton #CancelButton {
          @Sounds = $Sounds.@ButtonsCancel;
          @Anchor = (Left: 4);
          Text: %server.customUI.cancel;
          FlexWeight: 1;
        }
      }
    }
  }
}

// ── Colormap browser modal ─────────────────────────────────────────────────
$C.@PageOverlay #ColormapBrowserPage {
  LayoutMode: Middle;
  Visible: false;

  $C.@DecoratedContainer {
    Anchor: (Width: 600, Height: 550);

    #Title {
      $C.@Title {
        @Text = %server.customUI.heightmapImport.colormapBrowserTitle;
      }
    }

    #Content {
      LayoutMode: Top;
      Padding: (Full: 16);

      Label #CurrentPath {
        Anchor: (Bottom: 8, Horizontal: 4);
        Style: (...$C.@DefaultLabelStyle, FontSize: 12, TextColor: #6a7d8f);
        Text: "/";
      }

      Group #BrowserContent {
        FlexWeight: 1;

        Group {
          LayoutMode: Top;

          Group {
            LayoutMode: Left;
            Anchor: (Bottom: 10, Height: $C.@DropdownBoxHeight);

            $C.@TextField #SearchInput {
              @Anchor = (Left: 0);
              FlexWeight: 1;
              PlaceholderText: %server.customUI.heightmapImport.searchPlaceholder;
            }
          }

          Group #FileList {
            FlexWeight: 1;
            LayoutMode: TopScrolling;
            ScrollbarStyle: $C.@DefaultScrollbarStyle;
          }
        }
      }

      Group #BrowserButtons {
        LayoutMode: Center;
        Anchor: (Top: 12);

        $C.@TextButton #SelectButton {
          @Sounds = $Sounds.@SaveSettings;
          @Anchor = (Right: 4);
          Text: %server.customUI.select;
          FlexWeight: 1;
        }

        $C.@SecondaryTextButton #CancelButton {
          @Sounds = $Sounds.@ButtonsCancel;
          @Anchor = (Left: 4);
          Text: %server.customUI.cancel;
          FlexWeight: 1;
        }
      }
    }
  }
}

$C.@BackButton {}
